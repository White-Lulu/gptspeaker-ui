<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speaker-OwO</title>
    <style>
        .container {
    display: flex;
}

input, textarea {
    font-family: Arial, sans-serif;
}

.navbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 20px;
            border-bottom: 2px solid #ccc; /* åªæ˜¾ç¤ºä¸‹è¾¹æ¡† */
        }

.emoji {
    font-size: 24px; /* è¡¨æƒ…å¤§å° */
    margin-right: 10px; /* å³ä¾§é—´è· */
}

.nav-links {
    display: flex;
    gap: 15px; /* æ–‡å­—å—ä¹‹é—´çš„é—´è· */
}

.nav-links .active-nav {
        border: 2px solid;  /* æ·»åŠ è¾¹æ¡† */
        border-radius: 5px; /* ä¿æŒä¸å…¶ä»–æŒ‰é’®ä¸€è‡´çš„åœ†è§’ */
        color: black;       /* ä¿æŒæ–‡å­—é¢œè‰² */
}

.nav-links .noactive-nav {
                border: 2px solid;  /* æ·»åŠ è¾¹æ¡† */
                border-radius: 5px; /* ä¿æŒä¸å…¶ä»–æŒ‰é’®ä¸€è‡´çš„åœ†è§’ */
                color: black;       /* ä¿æŒæ–‡å­—é¢œè‰² */
        }
    
.nav-links a {
    text-decoration: none; /* å»æ‰è¶…é“¾æ¥çš„ä¸‹åˆ’çº¿ */
    color: black; /* æ–‡å­—é¢œè‰² */
    font-size: 16px;
    padding: 5px 10px; /* å†…è¾¹è· */
}

.nav-links4{
     /* åªæœ‰æœ€åä¸€ä¸ªæœ‰èƒŒæ™¯è‰² */
    color:#ffffff;
    border-radius: 5px; /* è®©æŒ‰é’®åœ†è§’ */
    border: 2px solid;  /* æ·»åŠ è¾¹æ¡† */
    border-radius: 5px; /* ä¿æŒä¸å…¶ä»–æŒ‰é’®ä¸€è‡´çš„åœ†è§’ */
    color: rgb(255, 255, 255);       /* ä¿æŒæ–‡å­—é¢œè‰² */
}

.output {
    flex: 2; /* å·¦ä¾§è¾ƒå¤§ */
    background: #f4f4f4;
    padding: 15px;
    border-radius: 10px;
    min-height: 400px;
    overflow-y: auto;
    border:2px solid #ccc
}

.input-section, .note-section {
    flex: 1; /* å³ä¾§å°ä¸€äº› */
    display: flex;
    flex-direction: column;
    gap: 10px;
}

textarea {
    width: 100%;
    padding: 10px;
    border:2px solid #ccc;
    border-radius: 5px;
    resize: none;
}
/* ä¸»å®¹å™¨ */
.container {
    display: flex;
    gap: 30px;
    margin-top: 20px;
    padding: 20px;
    min-height: 400px; /* è®©æ•´ä½“åŒºå—æ›´é•¿ */
}

/* ç¬¬ä¸€åˆ—ï¼ˆå·¦ä¾§ï¼‰ */
.left-column {
    flex: 4;
    background-color: #dddddd;
    padding: 20px;
    border-radius: 5px;
    min-height: 580px; /* å·¦ä¾§åŒºå—è‡³å°‘ 400px é«˜ */
    border:2px solid #ccc;
    white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œç¬¦å’Œç©ºæ ¼ */
    overflow-y: auto;    /* ä¿®æ”¹è¿™é‡Œï¼šä½¿ç”¨ auto è€Œä¸æ˜¯ true */
    max-height: 480px;   /* æ·»åŠ è¿™è¡Œï¼šé™åˆ¶æœ€å¤§é«˜åº¦ */
}

/* ç¬¬äºŒåˆ—ï¼ˆå³ä¾§ï¼ŒåŒ…å«ä¸¤è¡Œï¼‰ */
.right-column {
    flex: 3;
    display: flex;
    flex-direction: column;
    gap: 30px;
}

.right-down {
    display: flex;
    flex-direction: column; /* è®©å†…éƒ¨å†…å®¹å‚ç›´æ’åˆ— */
    gap: 25px; /* ä¸Šä¸‹é—´è· */
    flex: 3;
    padding:0px;
    border-radius: 5px;
    min-height: 330px; /* è®©å³ä¾§æ¯ä¸ªåŒºå—è‡³å°‘ 180px é«˜ */
}
.multi-line-input {
    flex: 3; /* è®©å¤šè¡Œè¾“å…¥æ¡†å æ®è¾ƒå¤šç©ºé—´ */
    padding: 10px;
    font-size: 16px;
    background-color: #ffffff;
    border:2px solid #ccc;
    border-radius: 5px;
    width: 100%; /* ç¡®ä¿å®½åº¦ä¸è¶…å‡ºçˆ¶å®¹å™¨ */
    box-sizing: border-box; /* è®© padding ä¸ä¼šæ’‘å¤§å®½åº¦ */
    resize: none; /* ç¦æ­¢æ‹–åŠ¨ï¼Œé˜²æ­¢è¶…å‡º */
    
}

.bottom-row {
    display: flex;
    gap: 25px; /* æ§ä»¶é—´è· */
    align-items: center;
}

.single-line-input {
    flex: 2; /* è®©è¾“å…¥æ¡†å æ®å¯ç”¨ç©ºé—´ */
    background-color: #ffffff;
    padding: 8px;
    font-size: 14px;
    border:2px solid #ccc;
    border-radius: 5px;
}

.action-btn1 {
    padding: 8px 12px;
    font-size: 14px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    color: white;
}

.action-btn2 {
    padding: 8px 12px;
    font-size: 14px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    color: white;
}
.right-top {
    flex: 3;
    padding: 0px;
    border-radius: 5px;
    min-height: 120px; /* ä¿æŒè¶³å¤Ÿé«˜åº¦ */
    display: flex;
    gap: 25px;
    align-items: stretch; /* è®©è¾“å…¥æ¡†å’ŒæŒ‰é’®ç»„å¡«å……æ•´ä¸ªé«˜åº¦ */
}

.prompt-input {
    flex: 1;
    padding: 10px;
    font-size: 16px;
    border:2px solid #ccc;
    background-color: #ffffff;
    border-radius: 5px;
    height: 100%; /* ç¡®ä¿å®½åº¦ä¸è¶…å‡ºçˆ¶å®¹å™¨ */
    box-sizing: border-box; /* è®© padding ä¸ä¼šæ’‘å¤§å®½åº¦ */
    resize: none; /* ç¦æ­¢æ‹–åŠ¨ï¼Œé˜²æ­¢è¶…å‡º */
}

.button-group {
    display: flex;
    flex-direction: column;
    justify-content: space-between; /* è®©æŒ‰é’®å‡åŒ€åˆ†å¸ƒ */
    gap: 25px;
    height: 100%; /* è®©æŒ‰é’®ç»„å¡«å……æ•´ä¸ªé«˜åº¦ */
}

button {
    flex: 1; /* è®©æ¯ä¸ªæŒ‰é’®ç­‰é«˜ */
    padding: 10px 15px;
    font-size: 14px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

.confirm-btn {
    color: rgb(255, 255, 255);
}

.deepseek-btn {
    background-color: #2360e3;
    color: white;
}

.openai-btn {
    background-color: #0b4267;
    color: white;
}

    </style>
</head>
<body>
    <div class="navbar">
        <span class="emoji">ğŸ˜Š</span> <!-- å·¦ä¾§è¡¨æƒ… -->
        <div class="nav-links">
            <a href="#" class="active-nav">Speaker</a>
            <a href="news.html" class="noactive-nav">News</a>
            <a href="notes.html" class="noactive-nav">Notes</a>
            <a class="nav-links4" href="settings.html">Setting</a> <!-- æœ€åä¸€ä¸ªæœ‰åº•è‰² -->
        </div>
    </div>
     <!-- ä¸»å®¹å™¨ï¼šåŒ…å«ä¸¤åˆ— -->
     <div class="container">
        <!-- ç¬¬ä¸€åˆ—ï¼ˆå·¦ä¾§å¤§åŒºå—ï¼‰ -->
        <div class="left-column" id="file-content">Waiting for submit</div>

        <!-- ç¬¬äºŒåˆ—ï¼ˆå³ä¾§åŒ…å«ä¸¤è¡ŒåŒºå—ï¼‰ -->
        <div class="right-column">
            <div class="right-top">
                <textarea class="prompt-input" placeholder="Here's your prompt"></textarea>
                <div class="button-group">
                    
                    <button class="deepseek-btn">DeepSeek</button>
                    <button class="openai-btn">OpenAI</button>
                    <button class="confirm-btn">â€” Submit ! â€”</button>
                </div>
            </div>
            <div class="right-down">
                <textarea class="multi-line-input" placeholder="Write down some notes"></textarea>
                <div class="bottom-row">
                    <input type="text" class="single-line-input" placeholder="Input notes' title">
                    <button class="action-btn1">Clear</button>
                    <button class="action-btn2">Submit !</button>
                </div>
            </div>
    </div>

    <script>
    
        // é¡µé¢åŠ è½½æ—¶åº”ç”¨ä¿å­˜çš„è®¾ç½®
        window.onload = function() {
    const savedBackgroundColor = localStorage.getItem('backgroundColor') || '#f4f4f4';
    const savedMainColor = localStorage.getItem('mainColor') || '#447de18f';
    const savedSubColor = localStorage.getItem('subColor') || '#ccc';
    const savedOpacity = localStorage.getItem('opacity') || '1'; // è¯»å–é€æ˜åº¦
    
    

    // æ¸…é™¤æ‰€æœ‰æŒ‰é’®çš„ âˆš
    document.querySelectorAll(".deepseek-btn, .openai-btn").forEach(btn => {
        btn.innerText = btn.innerText.replace(" âˆš", "");
    });

    // åº”ç”¨èƒŒæ™¯è‰²
    document.body.style.backgroundColor = savedBackgroundColor;
    document.querySelectorAll('.noactive-nav').forEach(a => {
        a.style.borderColor = savedBackgroundColor;});

    // åº”ç”¨ä¸»è‰²
    document.querySelector('.confirm-btn').style.backgroundColor = savedMainColor;
    document.querySelector('.action-btn2').style.backgroundColor = savedMainColor;
    document.querySelector('.active-nav').style.borderColor = savedMainColor;

    // åº”ç”¨è¾…åŠ©è‰²
    document.querySelector('.navbar').style.borderBottomColor = savedSubColor;
    document.querySelector('.nav-links4').style.backgroundColor = savedSubColor;
    document.querySelector('.nav-links4').style.borderColor = savedSubColor;
    document.querySelector('.left-column').style.borderColor = savedSubColor;
    document.querySelector('.multi-line-input').style.borderColor = savedSubColor;
    document.querySelector('.single-line-input').style.borderColor = savedSubColor;
    document.querySelector('.prompt-input').style.borderColor = savedSubColor;
    document.querySelector('.action-btn1').style.backgroundColor = savedSubColor;

    // è®¡ç®—èƒŒæ™¯é¢œè‰²äº®åº¦å¹¶è°ƒæ•´å­—ä½“é¢œè‰²
    document.querySelector('.nav-links4').style.color = getContrastColor(savedSubColor);
    document.querySelector('.action-btn1').style.color = getContrastColor(savedSubColor);

    // åº”ç”¨é€æ˜åº¦
    applyOpacity(savedOpacity);

     // ç»‘å®šæ»‘åŠ¨æ¡äº‹ä»¶ï¼Œä½¿ç”¨æˆ·è°ƒæ•´æ—¶å®æ—¶ç”Ÿæ•ˆ
     document.getElementById('opacity').addEventListener('input', function() {
        applyOpacity(this.value);
    });

    // è®¾ç½®æ»‘åŠ¨æ¡çš„å€¼ä¸ºä¿å­˜çš„é€æ˜åº¦
    document.getElementById('opacity').value = savedOpacity;

    

};

// åº”ç”¨é€æ˜åº¦
function applyOpacity(opacity) {
    document.querySelectorAll('.left-column, .prompt-input, .multi-line-input,.single-line-input').forEach(el => {
        // å…ˆè·å–åŸå§‹èƒŒæ™¯é¢œè‰²
        let bgColor = window.getComputedStyle(el).backgroundColor;
        let rgbaColor = convertToRGBA(bgColor, opacity);
        el.style.backgroundColor = rgbaColor;
    });
}

// é¢œè‰²è½¬æ¢å‡½æ•°ï¼šå°† `rgb(r, g, b)` æˆ– `#xxxxxx` è½¬æ¢ä¸º `rgba(r, g, b, opacity)`
function convertToRGBA(color, opacity) {
    let r, g, b;
    
    if (color.startsWith("rgb")) {
        // è§£æ `rgb(r, g, b)` å½¢å¼
        let rgbValues = color.match(/\d+/g);
        r = parseInt(rgbValues[0]);
        g = parseInt(rgbValues[1]);
        b = parseInt(rgbValues[2]);
    } else if (color.startsWith("#")) {
        // è§£æ `#RRGGBB` å½¢å¼
        let hex = color.replace("#", "");
        if (hex.length === 3) {
            hex = hex.split("").map(c => c + c).join("");
        }
        r = parseInt(hex.substring(0, 2), 16);
        g = parseInt(hex.substring(2, 4), 16);
        b = parseInt(hex.substring(4, 6), 16);
    } else {
        // é»˜è®¤è¿”å›ç™½è‰²
        return `rgba(255, 255, 255, ${opacity})`;
    }
    
    return `rgba(${r}, ${g}, ${b}, ${opacity})`;
}

// è®¡ç®—é¢œè‰²äº®åº¦å¹¶è¿”å›åˆé€‚çš„å¯¹æ¯”è‰²
function getContrastColor(hexColor) {
    // ç¡®ä¿ hexColor æ˜¯ #RRGGBB å½¢å¼
    hexColor = hexColor.replace(/^#/, '');
    if (hexColor.length === 3) {
        hexColor = hexColor.split('').map(c => c + c).join('');
    }

    // è§£æ RGB å€¼
    let r = parseInt(hexColor.substring(0, 2), 16) / 255;
    let g = parseInt(hexColor.substring(2, 4), 16) / 255;
    let b = parseInt(hexColor.substring(4, 6), 16) / 255;

    // è®¡ç®—ç›¸å¯¹äº®åº¦ï¼ˆç¬¦åˆ W3C WCAG æ ‡å‡†ï¼‰
    let luminance = 0.2126 * r + 0.7152 * g + 0.0722 * b;

    // äº®åº¦è¾ƒé«˜ï¼ˆèƒŒæ™¯è¾ƒæµ…ï¼‰ï¼Œç”¨é»‘è‰²ï¼›äº®åº¦è¾ƒä½ï¼ˆèƒŒæ™¯è¾ƒæ·±ï¼‰ï¼Œç”¨ç™½è‰²
    return luminance > 0.5 ? '#000000' : '#ffffff';

};

    </script>

<script>
    let selectedButton = null; // è®°å½•å½“å‰é€‰ä¸­çš„æŒ‰é’®

    function toggleButtonBorder(button) {
    if (selectedButton === button) {
        // å–æ¶ˆé€‰ä¸­ï¼Œç§»é™¤ âˆš
        button.innerText = button.innerText.replace(" âˆš", ""); // ç§»é™¤ âˆš
        selectedButton = null;
    } else {
        // å…ˆæ¸…é™¤å…¶ä»–æŒ‰é’®çš„ âˆš
        document.querySelectorAll(".deepseek-btn, .openai-btn").forEach(btn => {
            btn.innerText = btn.innerText.replace(" âˆš", ""); // ç§»é™¤ âˆš
        });

        // é€‰ä¸­å½“å‰æŒ‰é’®ï¼Œæ·»åŠ  âˆš
        button.innerText = button.innerText + " âˆš"; // æ·»åŠ  âˆš
        selectedButton = button;
    }
}

    document.querySelector(".deepseek-btn").addEventListener("click", function () {
        toggleButtonBorder(this);
    });

    document.querySelector(".openai-btn").addEventListener("click", function () {
        toggleButtonBorder(this);
    });

    // å‘é€æ•°æ®åˆ°æœåŠ¡å™¨
    async function submitPrompt() {
    const promptText = document.querySelector(".prompt-input").value.trim();
    if (!promptText) {
        alert("Please enter your prompt");
        return;
    }

    const selectedModel = selectedButton ? selectedButton.innerText.replace(" âˆš", "").trim() : null;
    if (!selectedModel) {
        alert("Please select one of the models: DeepSeek or OpenAI");
        return;
    }

    await runScript();

    async function runScript() {
    try {
        // ä½¿ç”¨å®Œæ•´çš„æœåŠ¡å™¨URL
        const response = await fetch(`http://localhost:5000/submit_model_prompt`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            // æ·»åŠ è¯·æ±‚ä½“ï¼Œä¼ é€’promptå†…å®¹
            body: JSON.stringify({
                model: selectedModel,
                prompt: document.querySelector(".prompt-input").value.trim()
            })
        });

        if (response.ok) {
            const result = await response.json();
            console.log("è„šæœ¬è¿è¡ŒæˆåŠŸ:", result);
        } else {
            console.error("è„šæœ¬è¿è¡Œå¤±è´¥:", response.statusText);
        }
    } catch (error) {
        console.error("è¯·æ±‚é”™è¯¯:", error);
}
}

    
    }
    document.querySelector(".confirm-btn").addEventListener("click", submitPrompt);
</script>

<script>
    document.querySelector(".action-btn2").addEventListener("click", function () {
    const title = document.querySelector(".single-line-input").value.trim();
    const content = document.querySelector(".multi-line-input").value.trim();

    if (!title || !content) {
        alert("Please enter both title and content");
        return;
    }

    // è·å–å½“å‰æ—¥æœŸ
    const date = new Date().toLocaleString();

    // åˆ›å»º note å¯¹è±¡
    const note = {
        title,
        content,
        date
    };

    // ä» localStorage ä¸­è¯»å–ç°æœ‰çš„ notes
    const notes = JSON.parse(localStorage.getItem("notes")) || [];

    // æ·»åŠ æ–°çš„ note
    notes.push(note);

    // ä¿å­˜åˆ° localStorage
    localStorage.setItem("notes", JSON.stringify(notes));

    // æ¸…ç©ºè¾“å…¥æ¡†
    document.querySelector(".single-line-input").value = "";
    document.querySelector(".multi-line-input").value = "";

    alert("Note saved successfully!");
});

document.querySelector(".action-btn1").addEventListener("click", function () {
    // æ¸…ç©ºè¾“å…¥æ¡†
    document.querySelector(".single-line-input").value = "";
    document.querySelector(".multi-line-input").value = "";

});


    async function updateFileContent() {
        try {
            const response = await fetch("http://localhost:5000/read_txt");
            if (response.ok) {
                const result = await response.json();
                document.getElementById("file-content").textContent = result.content;
            } else {
                document.getElementById("file-content").textContent = "æ–‡ä»¶è¯»å–å¤±è´¥";
            }
        } catch (error) {
            document.getElementById("file-content").textContent = "è¯·æ±‚é”™è¯¯ï¼š" + error;
        }
    }

    // æ¯ 2 ç§’æ›´æ–°ä¸€æ¬¡
    setInterval(updateFileContent, 2000);

    // é¡µé¢åŠ è½½æ—¶ç«‹å³æ›´æ–°
    updateFileContent();
</script>
</body>
</html>
